--- a/src/core/reference/PropertyField.h
+++ b/src/core/reference/PropertyField.h
@@ -159,9 +159,10 @@
 	// This undo class records a change to the property value.
 	class PropertyChangeOperation : public UndoableOperation {
 	public:
-		PropertyChangeOperation(PropertyField& field) : _field(field), _owner(field.owner() != field.owner()->dataset() ? field.owner() : nullptr) {
+		PropertyChangeOperation(PropertyField& field) : _field(field) {
 			// Make a copy of the current property value.
-			_oldValue = field;
+			_owner = field.owner() != dynamic_cast<Ovito::RefMaker*>(field.owner()->dataset()) ? field.owner() : nullptr;
+                        _oldValue = field;
 		}
 		/// Restores the old property value.
 		virtual void undo() override {
